import{d as q,o,c as i,H as te,a as e,k as p,Q as se,x as L,_ as D,r as z,b as S,g as k,j as Z,n as v,R as ne,C as oe,F as N,q as j,t as x,p as T,m as I,P as ie,s as Q,l as O,y as J}from"./index-Ii46O6WK.js";import{M as X}from"./ModalPopScreen-BQRIfxQi.js";import{u as G,i as ae}from"./useFetchRequest-Bo5LzZLV.js";import{A as le}from"./ArticleList-Dll28oBx.js";const ce={class:"w-full h-full relative flex-1 overflow-hidden"},de={key:0,class:"absolute loading-mask"},re={class:"loading-spinner"},ue=q({__name:"WrapperLoading",props:{loading:{type:Boolean}},setup(r){return(c,a)=>(o(),i("div",ce,[te(c.$slots,"default",{},void 0,!0),c.loading?(o(),i("div",de,[e("div",re,[p(se)])])):L("",!0)]))}}),ve=D(ue,[["__scopeId","data-v-4c6fb3a6"]]),pe={class:"m-center"},me=q({__name:"NoData",setup(r){return(c,a)=>(o(),i("div",pe,a[0]||(a[0]=[e("svg",{id:"mx_n_1755078231245",t:"1755078231243",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"11192",width:"100",height:"100"},[e("path",{d:"M730.5 71.2v58.7c0 37.7 30.6 68.3 68.3 68.3h58.7l-127-127zM867 198.1L730.5 61.6v9.6l126.9 126.9h9.6z m102.5 403.8C983 592 983 571 983 553.1c0-24.3 0-54.6-33.8-54.6-1.6 0-3.2 0.1-4.7 0.2l-40-164.5 17.2-54.3c0-15-12.3-27.3-27.3-27.3h-20.5v-57.5L733.3 54.7H211.6c-33.9 0-61.4 27.5-61.4 61.4v136.5h-20.5c-15.1 0-27.3 12.3-27.3 27.3l17.1 54.6-40.1 165c-1.4-0.1-2.8-0.2-4.2-0.2h-0.1c-33.2 0-33.2 29.7-33.2 53.6 0 17.4 0.1 37.8 12.8 47.7L0 826.1c0 15 12.3 27.3 27.3 27.3h122.9v27.3c0 7.6 1.5 14.8 4.1 21.6 8.8 23.3 31.1 39.8 57.4 39.8h600.8c26 0 48.2-16.2 57.2-39.1 2.7-7 4.3-14.5 4.3-22.3v-27.3h122.9c15 0 27.3-12.3 27.3-27.3l-54.7-224.2z m-866-20.6c-7.6 7.6-17.6 11.7-28.4 11.7-15.9 0-19.1-7.9-19.5-34.6V553c0-30.9 2.6-40 19.5-40h1.1c21.6 0.6 39 18.1 39 39.9-0.1 10.8-4.1 20.9-11.7 28.4z m708.9 347.2H211.6c-19.1 0-35.6-11.3-43.3-27.6-2.9-6.2-4.5-12.9-4.5-20.1V116.2c0-26.3 21.4-47.8 47.8-47.8h516.1l2.8 2.8v-9.6L867 198.1h-9.6l2.8 2.8v679.9c0 7.4-1.8 14.5-4.8 20.8-7.8 16-24.1 27-43 26.9z m156.9-369.9v0.6c0 1.6 0 3.1-0.1 4.6v0.2c0 1.6-0.1 3.1-0.2 4.5v0.1c-1 18-5.1 25.3-19.8 25.3-22.6 0-41-18.3-41-41 0-22.1 17.6-40.1 39.4-40.9 0.6 0 1-0.1 1.5-0.1 18.5 0 20.1 11.2 20.1 41v5.7zM812.4 942.2H211.6c-26.2 0-48.6-16.6-57.4-39.8-66.5 7.1-106.5 16.2-106.5 26.1 0 22.6 206.3 41 460.8 41s460.8-18.3 460.8-41c0-9.6-37.5-18.5-99.8-25.5-8.9 23-31.1 39.2-57.1 39.2",fill:"#E5E5E5","p-id":"11193"}),e("path",{d:"M798.7 198.1c-37.7 0-68.3-30.6-68.3-68.3V71.2l-2.8-2.8h-516c-26.3 0-47.8 21.4-47.8 47.8v764.6c0 7.3 1.6 14.1 4.5 20.2 7.6 16.3 24.1 27.6 43.3 27.6h600.7c18.9 0 35.2-11 43-27 3.1-6.3 4.8-13.3 4.8-20.8V200.9l-2.8-2.8h-58.6zM76.1 513.2H75c-17 0-19.5 9-19.5 40v5.4c0 2.9 0.1 5.5 0.2 8v0.4c0.1 2.5 0.3 4.6 0.5 6.6v0.4c0.2 2 0.5 3.8 0.9 5.4 0 0.1 0 0.2 0.1 0.3 0.4 1.6 0.9 3.1 1.4 4.5 2.8 6.5 7.6 8.9 16.3 8.9 10.8 0 20.8-4.2 28.4-11.7 7.6-7.6 11.7-17.6 11.6-28.3 0.2-21.8-17.2-39.5-38.8-39.9z m873-1.1c-0.5 0-1 0.1-1.5 0.1-21.9 0.7-39.5 18.8-39.5 40.9 0 22.6 18.3 41 41 41 8.6 0 13.5-2.6 16.4-8.3v0.1c0.1-0.1 0.1-0.3 0.2-0.5 0.3-0.5 0.5-1.3 0.7-1.9 0.2-0.6 0.4-1.3 0.7-2 0.2-0.6 0.3-1.4 0.5-2.1 0.2-0.9 0.3-1.8 0.4-2.8 0.1-0.8 0.2-1.4 0.3-2.1 0.2-1.7 0.3-3.6 0.5-5.7v-0.1c0.1-1.4 0.1-2.9 0.2-4.5v-0.2c0-1.5 0.1-3 0.1-4.6v-6.2c0.2-29.8-1.5-41.1-20-41.1z",fill:"#FFFFFF","p-id":"11194"}),e("path",{d:"M385 327.8c-17.8 0-32.3 14.4-32.3 32.2 0 17.7 14.4 32.1 32.1 32.2 17.8 0.1 32.2-14.3 32.3-32.1 0.1-17.8-14.3-32.2-32.1-32.3z m254 0c-17.8 0-32.3 14.4-32.3 32.2 0 17.7 14.4 32.1 32.1 32.2 17.8 0.1 32.2-14.3 32.3-32.1 0.2-17.8-14.2-32.2-32.1-32.3z m-47.6 151.9H437.8c-1.8 0-3.6 0.7-4.9 2-1.3 1.3-2 3.2-1.9 5 1.4 43.9 36.9 79.5 80.9 80.9h2.8c44.9 0 82-35.7 83.5-80.9 0.1-1.8-0.7-3.6-1.9-5-1.3-1.3-3.1-2-4.9-2z m-79.1 74.2c-18-0.5-34.2-8-46.3-19.7 8.3-10.8 25.8-18.2 46.1-18.2 22.1 0 40.9 8.9 48 21.1-12.9 11.1-29.6 17.5-47.8 16.8z",fill:"#E5E5E5","p-id":"11195"}),e("path",{d:"M266.2 424.4c0 11.9 14.5 21.5 32.3 21.5s32.3-9.6 32.3-21.5-14.5-21.5-32.3-21.5-32.3 9.6-32.3 21.5m426.9 0c0 11.9 14.5 21.5 32.3 21.5s32.3-9.6 32.3-21.5-14.5-21.5-32.3-21.5-32.3 9.6-32.3 21.5M512 516c-20.3 0-37.8 7.5-46.1 18.2 12.1 11.7 28.4 19.2 46.3 19.7 18.1 0.7 35-5.9 47.8-16.9-7.1-12.2-25.9-21-48-21",fill:"#F5F5F5","p-id":"11196"})],-1)])))}}),Y=D(me,[["__scopeId","data-v-375a9266"]]),fe={},he={t:"1755142449663",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"14139",fill:"currentColor"};function _e(r,c){return o(),i("svg",he,c[0]||(c[0]=[e("path",{d:"M834.485 82h-644.969c-14.854 0-26.875 12.021-26.875 26.875v806.237a26.893 26.893 0 0 0 14.172 23.673c8.768 4.724 19.289 4.199 27.582-1.287l307.609-204.307 307.592 204.307a26.876 26.876 0 0 0 14.883 4.489c4.352 0 8.711-1.05 12.705-3.202a26.873 26.873 0 0 0 14.176-23.673v-806.237c0.005-14.854-12.02-26.875-26.875-26.875z m-26.875 783.01l-269.645-179.113c-15.379-10.236-36.324-10.288-51.807-0.059l-269.768 179.172v-729.261h591.219v729.261z","p-id":"14140"},null,-1),e("path",{d:"M377.637 431.403h107.492v107.524c0 14.829 12.02 26.875 26.875 26.875s26.875-12.046 26.875-26.875v-107.524h107.49c14.855 0 26.875-12.021 26.875-26.874 0-14.861-12.02-26.908-26.875-26.908h-107.49v-107.499c0-14.854-12.02-26.874-26.875-26.874s-26.875 12.021-26.875 26.874v107.499h-107.492c-14.828 0-26.875 12.047-26.875 26.908 0 14.853 12.047 26.874 26.875 26.874z","p-id":"14141"},null,-1)]))}const U=D(fe,[["render",_e]]);async function ge(r,c){return z(`${S}/subscriptions/`,{method:"GET",params:r})}async function be(r,c){return z(`${S}/subscriptions/`,{method:"POST",data:r})}async function ee(r,c){return z(`${S}/subscriptions/${r}/cancel`,{method:"PUT"})}async function xe(r,c){return z(`${S}/subscriptions/articles`,{method:"GET",params:r,...c||{}})}async function ke(r,c,a){return z(`${S}/subscriptions/${r}/articles`,{method:"GET",params:c,...a||{}})}async function ye(r,c){return z(`${S}/user/recommendations/search`,{method:"POST",data:r})}async function $e(r){return z(`${S}/user/recommendations/change`,{method:"GET"})}const we={class:"recommended-content"},Ce={class:"text-center"},ze={key:0,class:"m-20"},Se={key:0},Pe={class:"m-20"},Le=["onClick"],Me={class:"icon-svg"},Fe={key:1,class:"color-text-3 text-center"},Re={key:1,class:"m-20"},Ve={key:0},Ae={class:"m-20 tip-text"},Ee={class:"m-20"},He=["onClick"],De={class:"icon-svg"},Be={key:1,class:"color-text-3 text-center mb-10"},Ne={key:2,class:"m-20"},je={class:"m-20"},Te=["onClick"],Ie={class:"icon-svg"},Ge=q({__name:"RecommendedContent",props:{threeData:{}},emits:["refresh"],setup(r,{emit:c}){const a=r,P=c,f=k(""),h=k(""),g=k(),$=k(),b=k(a.threeData),{loading:M,refresh:K}=G(s=>ye({...s,keyword:h.value}),{manual:!0,paginated:!0,defaultPageSize:50,formatResult(s){return s==null?void 0:s.data},onSuccess(s){s&&s.success&&(g.value=s==null?void 0:s.data)}});G(()=>$e(),{formatResult(s){return s==null?void 0:s.data},onSuccess(s){s&&s.success&&($.value=s==null?void 0:s.data)}});const F=(s,d,n)=>{s.done||be({topic_name:s.title,topic_description:s.description}).then(t=>{t&&t.success&&(n==="data"?g.value.recommendations[d]={...g.value.recommendations[d],done:!0}:$.value.recommendations[d]={...$.value.recommendations[d],done:!0},P("refresh"))})},R=(s,d)=>{s.done||ee(s.id).then(n=>{n&&n.success&&(b.value[d]={...b.value[d],done:!0},P("refresh"))})},B=()=>{M.value||!f.value||(h.value=f.value,K())};return(s,d)=>{var t,_,w,V,u,m,C,A,E,H;const n=Z("el-input");return o(),i("div",we,[e("div",Ce,[p(n,{modelValue:f.value,"onUpdate:modelValue":d[0]||(d[0]=l=>f.value=l),modelModifiers:{trim:!0},class:"w-50 m-2",size:"large",placeholder:"请输入话题","prefix-icon":v(ne),style:{width:"80%"},onKeyup:oe(B,["enter"])},null,8,["modelValue","prefix-icon"])]),h.value?L("",!0):(o(),i("div",ze,[(t=b.value)!=null&&t.length?(o(),i("div",Se,[d[1]||(d[1]=e("div",{class:"m-20 color-text-3 text-center invisible"},"占位",-1)),d[2]||(d[2]=e("div",{class:"tip-text m-20"},"我最新订阅话题",-1)),e("div",Pe,[(o(!0),i(N,null,j(b.value,(l,y)=>(o(),i("div",{key:l.id,class:"flex justify-between items-center mb-10",onClick:W=>R(l,y)},[e("div",null,x(l.topic_name),1),e("span",{class:T(["subscribe-btn shrink-0 pointer",{on:l.done}])},[e("i",Me,[p(U)]),I(x(l.done?"已取消":"取消订阅"),1)],2)],8,Le))),128))])])):(o(),i("div",Fe,"暂无订阅"))])),h.value?(o(),i("div",Re,[(w=(_=g.value)==null?void 0:_.recommendations)!=null&&w.length?(o(),i("div",Ve,[d[3]||(d[3]=e("div",{class:"m-20 color-text-3 text-center invisible"},"占位",-1)),e("div",Ae," 搜索到"+x((u=(V=g.value)==null?void 0:V.recommendations)==null?void 0:u.length)+"个相关结果 ",1),e("div",Ee,[(o(!0),i(N,null,j((m=g.value)==null?void 0:m.recommendations,(l,y)=>(o(),i("div",{key:l.id,class:"flex justify-between items-center mb-10",onClick:W=>F(l,y,"data")},[e("div",null,x(l.title),1),e("span",{class:T(["subscribe-btn shrink-0 pointer",{on:l.done}])},[e("i",De,[p(U)]),I(x(l.done?"已订阅":"订阅"),1)],2)],8,He))),128))])])):(o(),i("div",Be,"找不到相关话题"))])):L("",!0),!h.value&&!((C=b.value)!=null&&C.length)||h.value&&!((E=(A=g.value)==null?void 0:A.recommendations)!=null&&E.length)?(o(),i("div",Ne,[d[4]||(d[4]=e("div",{class:"tip-text"},"猜你想要看",-1)),e("div",je,[(o(!0),i(N,null,j((H=$.value)==null?void 0:H.recommendations,(l,y)=>(o(),i("div",{key:l.id,class:"flex justify-between items-center mb-10",onClick:W=>F(l,y,"recommendationsData")},[e("div",null,x(l.title),1),e("span",{class:T(["subscribe-btn shrink-0 pointer",{on:l.done}])},[e("i",Ie,[p(U)]),I(x(l.done?"已订阅":"订阅"),1)],2)],8,Te))),128))])])):L("",!0)])}}}),qe=D(Ge,[["__scopeId","data-v-c0f9057b"]]),Ke={class:"flex flex-1 h-full"},Oe={class:"l-column"},Ue={class:"l-menu-list"},We=["onClick"],Qe={class:"flex justify-between items-center topic-item"},Je={class:"flex-1"},Xe=["onClick"],Ye={class:"r-column flex flex-col grow h-screen overflow-hidden"},Ze={class:"flex header px-40 shrink-0"},e1={class:"font-semibold text-lg"},t1={key:0,class:"text-center text-md empty-content"},s1={key:1,class:"flex h-full w-full flex-1 flex-col overflow-hidden"},n1={class:"py-20 px-20 flex justify-end"},o1={key:2,class:"text-center text-md empty-content"},i1={class:"m-20"},a1=q({__name:"SubscriptionView",setup(r){const c=k(!1),a=k(null),P=k(null),f=k(!1),{data:h,loading:g,resetPage:$,pagination:b}=G(n=>{var _,w;return((_=a==null?void 0:a.value)!=null&&_.id?ke:xe)((w=a==null?void 0:a.value)==null?void 0:w.id,n)},{paginated:!0,defaultPageSize:50,formatResult(n){return n==null?void 0:n.data}});ie(()=>a.value,n=>{n&&$()});const{data:M,loading:K,resetPage:F}=G(n=>ge(n),{paginated:!0,defaultPageSize:50,formatResult(n){return n==null?void 0:n.data},onSuccess(n){var _;const t=n.data.subscriptions;if(a.value&&((_=a.value)==null?void 0:_.id)===P.value){if(!(t!=null&&t.length))return;a.value=t==null?void 0:t[0]}}}),R=()=>{c.value=!0},B=n=>{a.value=n?{...n}:null},s=n=>{P.value=n.id,f.value=!0},d=()=>{ee(P.value).then(n=>{n&&n.success&&(F(),f.value=!1)})};return(n,t)=>{var V;const _=Z("el-pagination"),w=ve;return o(),i("div",Ke,[e("div",Oe,[t[6]||(t[6]=e("div",{class:"header font-semibold text-xl"},"订阅列表",-1)),e("div",Ue,[e("div",null,[e("div",{class:"menu-type select-on flex items-center justify-between pointer",onClick:t[0]||(t[0]=u=>{B(),v($)()})},[t[5]||(t[5]=e("div",null,"话题订阅",-1)),e("span",{class:"add-icon-btn",onClick:Q(R,["stop"])},t[4]||(t[4]=[e("i",null,"+",-1)]))]),e("ul",null,[(o(!0),i(N,null,j((V=v(M))==null?void 0:V.subscriptions,u=>{var m;return o(),i("li",{key:u.id,class:T({on:((m=a.value)==null?void 0:m.id)===u.id}),onClick:C=>B(u)},[e("div",Qe,[e("div",Je,x(u.topic_name),1),e("div",{class:"shrink-0 del-topic",onClick:Q(C=>s(u),["stop"])},[p(v(ae),{size:"16"})],8,Xe)])],10,We)}),128))]),e("div",{class:"create-button pointer",onClick:R}," +  新建订阅 ")])])]),e("div",Ye,[e("div",Ze,[e("div",e1,x(a.value?a.value.topic_name:"全部订阅"),1)]),p(w,{loading:v(g)},{default:O(()=>{var u,m,C,A,E,H,l,y;return[!((m=(u=v(M))==null?void 0:u.subscriptions)!=null&&m.length)&&!v(K)?(o(),i("div",t1,[p(Y),t[7]||(t[7]=e("div",null,"还没有订阅内容，去订阅一个吧！",-1)),e("div",{class:"create-button small-btn pointer",onClick:R}," +  新建订阅 ")])):(A=(C=v(h))==null?void 0:C.articles)!=null&&A.length?(o(),i("div",s1,[t[8]||(t[8]=e("div",{class:"inline-flex gap-2 font-semibold m-20 mb-10 px-40"},[e("span",{class:"icon-svg"},[e("svg",{t:"1755162019969",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"16433",fill:"currentColor",width:"25",height:"25"},[e("path",{d:"M927.8464 575.8464a25.6 25.6 0 0 1 3.7888 32.5632l-2.8672 3.584-251.5456 264.8064a51.2 51.2 0 0 1-69.9392 4.0448l-4.5056-4.3008-109.4656-116.736a25.6 25.6 0 0 1 33.8944-38.0928l3.4816 3.072 109.4144 116.736 251.5456-264.7552a25.6 25.6 0 0 1 36.1984-0.9216zM358.4 821.76a23.04 23.04 0 0 1 4.1472 45.7216l-4.096 0.3584H153.6a23.04 23.04 0 0 1-4.1984-45.7216L153.6 821.76h204.8z m256-307.0976a23.04 23.04 0 0 1 4.1472 45.7216l-4.096 0.3584H153.6a23.04 23.04 0 0 1-4.1984-45.7216L153.6 514.6624h460.8z m256-307.3024a23.04 23.04 0 0 1 4.096 45.7216L870.4 253.44H153.6a23.04 23.04 0 0 1-4.096-45.7216L153.6 207.36h716.8z","p-id":"16434"})])]),I(" 重点提炼 ")],-1)),p(le,{class:"flex-1 px-40","article-result":v(h)},null,8,["article-result"]),e("div",n1,[p(_,{"hide-on-single-page":!0,"current-page":((E=v(b))==null?void 0:E.current)||1,total:((H=v(h))==null?void 0:H.total)||0,"page-size":(l=v(b))==null?void 0:l.pageSize,layout:"prev, pager, next",onCurrentChange:(y=v(b))==null?void 0:y.changeCurrent},null,8,["current-page","total","page-size","onCurrentChange"])])])):(o(),i("div",o1,[p(Y),t[9]||(t[9]=e("div",null,"未发掘对应的优质文章！",-1))]))]}),_:1},8,["loading"])]),c.value?(o(),J(X,{key:0,width:680,title:"话题订阅",onClose:t[1]||(t[1]=u=>c.value=!1)},{default:O(()=>{var u,m;return[p(qe,{"three-data":(m=(u=v(M))==null?void 0:u.subscriptions)==null?void 0:m.slice(0,3),onRefresh:v(F)},null,8,["three-data","onRefresh"])]}),_:1})):L("",!0),f.value?(o(),J(X,{key:1,width:450,title:"取消话题订阅",onClose:t[3]||(t[3]=u=>f.value=!1)},{default:O(()=>[e("div",null,[t[10]||(t[10]=e("div",{class:"py-20"},"确认取消对此话题的订阅吗？",-1)),e("div",i1,[e("button",{class:"base-button ghost-button",onClick:t[2]||(t[2]=u=>f.value=!1)}," 取消 "),e("button",{class:"base-button dangler-button",onClick:d}," 删除 ")])])]),_:1})):L("",!0)])}}}),u1=D(a1,[["__scopeId","data-v-42bb5314"]]);export{u1 as default};
