import{j as n}from"./semi-ui-CsG5M4aO.js";import{r as s}from"./react-core-DtMAePju.js";import{S as j,u as D,N as E,A as P,a as x,s as b}from"./index-DLhw3Ufm.js";import{u as y}from"./i18n-5-7yKGUP.js";import{m as A}from"./tools-2z7G0C69.js";import"./react-components-XvIrFW7f.js";const q=()=>{var f,g,p;const{t:M,i18n:m}=y(),[e]=s.useContext(j),[w,_]=s.useState(!1),[i,l]=s.useState(""),[I,u]=s.useState(!1),v=D();(f=e==null?void 0:e.status)!=null&&f.demo_site_enabled,(g=e==null?void 0:e.status)!=null&&g.docs_link,(p=e==null?void 0:e.status)!=null&&p.server_address||window.location.origin;const h=P.map(a=>({value:a})),[W,N]=s.useState(0);m.language.startsWith("zh");const S=async()=>{l(localStorage.getItem("home_page_content")||"");const a=await x.get("/api/home_page_content"),{success:r,message:d,data:t}=a.data;if(r){let c=t;if(t.startsWith("https://")||(c=A.parse(t)),l(c),localStorage.setItem("home_page_content",c),t.startsWith("https://")){const o=document.querySelector("iframe");if(o){const C=localStorage.getItem("theme-mode")||"light";o.onload=()=>{o.contentWindow.postMessage({themeMode:C},"*"),o.contentWindow.postMessage({lang:m.language},"*")}}}}else b(d),l("加载首页内容失败...");_(!0)};return s.useEffect(()=>{(async()=>{const r=localStorage.getItem("notice_close_date"),d=new Date().toDateString();if(r!==d)try{const t=await x.get("/api/notice"),{success:c,data:o}=t.data;c&&o&&o.trim()!==""&&u(!0)}catch(t){console.error("获取公告失败:",t)}})()},[]),s.useEffect(()=>{S().then()},[]),s.useEffect(()=>{const a=setInterval(()=>{N(r=>(r+1)%h.length)},3e3);return()=>clearInterval(a)},[h.length]),n.jsxs("div",{className:"w-full overflow-x-hidden",children:[n.jsx(E,{visible:I,onClose:()=>u(!1),isMobile:v}),w&&i===""?n.jsx("div",{className:"w-full overflow-x-hidden",children:"首页"}):n.jsx("div",{className:"overflow-x-hidden w-full",children:i.startsWith("https://")?n.jsx("iframe",{src:i,className:"w-full h-screen border-none"}):n.jsx("div",{className:"mt-[64px]",dangerouslySetInnerHTML:{__html:i}})})]})};export{q as default};
