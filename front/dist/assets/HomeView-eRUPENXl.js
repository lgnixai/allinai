import{u as U}from"./loginState-C2cpEv3v.js";import{_ as M,o as c,c as f,a as e,r as I,b as V,d as G,u as s1,e as l1,f as n1,g as v,h as i1,i as a1,j as C,w as c1,v as d1,k as s,l as a,m as x,n as p,p as L,F as q,q as u1,t as P,s as F,x as B,y as J,z as r1}from"./index-Ii46O6WK.js";import{u as p1,L as j,e as f1,f as v1,o as _1,w as m1}from"./useFetchRequest-Bo5LzZLV.js";import{M as h1}from"./ModalPopScreen-BQRIfxQi.js";import{e as D}from"./eventBus-CGRXT3Tn.js";import{l as x1}from"./services-nyJye1FA.js";const w1={},g1={t:"1754363554816",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5365",width:"30",height:"30"};function k1(r,n){return c(),f("svg",g1,n[0]||(n[0]=[e("path",{d:"M88.939 464.455a448.014 448.014 0 1 0 896.028 0 448.014 448.014 0 1 0-896.028 0z",fill:"#FFE585","p-id":"5366"},null,-1),e("path",{d:"M547.508 24.443c-4.2 0-8.422 0.079-12.594 0.194 223.7 6.375 403.065 189.699 403.065 414.939 0 229.268-185.86 415.132-415.132 415.132-229.256 0-415.132-185.864-415.132-415.132 0-36.104 4.62-71.144 13.284-104.552-13.959 43.305-21.505 89.484-21.505 137.434 0 247.427 200.6 448.014 448.014 448.014 247.431 0 448.014-200.587 448.014-448.014 0-247.432-200.583-448.015-448.014-448.015z",fill:"#FF9900",opacity:".24","p-id":"5367"},null,-1),e("path",{d:"M437.757 1024h197.29a16.44 16.44 0 0 0 0-32.882h-197.29a16.44 16.44 0 0 0 0 32.882z",fill:"#6E6E96",opacity:".29","p-id":"5368"},null,-1),e("path",{d:"M708.48 1024h57.544a16.44 16.44 0 0 0 0-32.882h-57.543a16.44 16.44 0 0 0 0 32.882z m-349.368-32.882H313.9a16.44 16.44 0 0 0 0 32.882h45.212a16.44 16.44 0 0 0 0-32.882z",fill:"#6E6E96",opacity:".17","p-id":"5369"},null,-1),e("path",{d:"M125.931 487.061c0-234.948 190.46-425.408 425.408-425.408 229.852 0 417.093 182.301 425.108 410.188 0.18-5.183 0.3-10.378 0.3-15.606 0-247.428-200.6-448.015-448.014-448.015C281.3 8.22 80.719 208.807 80.719 456.235c0 205.955 138.983 379.435 328.308 431.82C244.07 829.495 125.93 672.098 125.93 487.06z",fill:"#FFEFB5","p-id":"5370"},null,-1),e("path",{d:"M244.531 452.98c-4.15 144.252 45.986 270.925 166.769 304.932 120.778 34.008 274.945-35.121 346.689-160.331L244.53 452.979z",fill:"#C7A17B","p-id":"5371"},null,-1),e("path",{d:"M228.095 452.507c-4.842 168.264 61.982 288.352 178.75 321.234 129.956 36.593 290.464-37.19 365.406-167.985a16.45 16.45 0 0 0-9.815-24l-513.45-144.601a16.437 16.437 0 0 0-20.891 15.352zM743.722 589.41c-66.664 116.348-213.79 184.837-327.963 152.678-146.02-41.114-156.895-215.544-154.79-288.636a16.453 16.453 0 0 1-20.893 15.352l513.457 144.605a16.445 16.445 0 0 1-9.811-24z",fill:"#6E6E96","p-id":"5372"},null,-1),e("path",{d:"M313.065 97.955c68.275-42.57 147.117-65.073 227.998-65.073 115.276 0 223.65 44.892 305.164 126.406 81.518 81.513 126.41 189.892 126.41 305.167 0 237.97-193.608 431.573-431.574 431.573-237.97 0-431.573-193.603-431.573-431.573 0-51.966 9.133-102.768 27.14-151.005a16.44 16.44 0 0 0-30.806-11.497C86.44 353.878 76.608 408.552 76.608 464.455c0 256.108 208.347 464.455 464.455 464.455 256.104 0 464.455-208.347 464.455-464.455 0-124.059-48.315-240.695-136.044-328.419C781.754 48.312 665.122 0 541.064 0c-87.039 0-171.898 24.226-245.397 70.055a16.44 16.44 0 0 0 17.398 27.9z",fill:"#6E6E96","p-id":"5373"},null,-1),e("path",{d:"M414.736 273.079a36.992 36.992 0 1 0 73.984 0 36.992 36.992 0 1 0-73.984 0zM674.025 341.05a36.992 36.992 0 1 0 73.984 0 36.992 36.992 0 1 0-73.984 0z",fill:"#6E6E96","p-id":"5374"},null,-1),e("path",{d:"M219.373 277.008c9.342-28.442 38.393-63.326 64.682-77.646l0.099-0.061c26.42-14.275 26.42-37.58 0-51.822l-0.099-0.086c-26.293-14.255-56.865-46.38-67.938-71.354-11.052-25.015-29.174-25.015-40.255 0-11.036 25.007-41.637 57.116-68.053 71.35l-0.123 0.098c-26.343 14.254-26.343 37.543 0 51.83l0.123 0.05c26.416 14.258 55.394 49.195 64.662 77.637l6.659 20.124c9.301 28.467 24.32 28.467 33.679 0l6.564-20.12z",fill:"#CFD3FF","p-id":"5375"},null,-1),e("path",{d:"M234.992 282.138c8.1-24.65 34.168-55.944 56.93-68.337l0.3-0.164 0.292-0.177-0.542 0.304c18.08-9.765 28.446-24.492 28.438-40.403-0.004-15.903-10.374-30.609-28.45-40.358l3.057 2.129-1.393-1.225a48.891 48.891 0 0 0-1.73-0.974c-23.236-12.594-51.05-41.703-60.745-63.56-10.97-24.822-26.725-28.534-35.139-28.538s-24.172 3.7-35.183 28.541c-9.66 21.883-37.506 50.971-60.82 63.536l-1.33 0.72-1.185 0.953 2.372-1.562c-18.023 9.754-28.36 24.456-28.369 40.342-0.008 15.894 10.33 30.617 28.353 40.4l0.928 0.5 0.983 0.379-1.755-0.818c22.75 12.277 48.784 43.54 56.848 68.267l6.68 20.193c8.8 26.939 22.474 32.619 32.4 32.627s23.626-5.647 32.508-32.656l6.552-20.12z m-37.794 9.86c-2.947 8.957-5.479 11.279-5.508 11.3 1.879-1.665 6.667-1.657 8.541 0.008-0.028-0.021-2.548-2.34-5.466-11.279l-6.68-20.185c-10.604-32.52-42.445-70.737-72.47-86.94l-0.909-0.493-0.966-0.374 1.784 0.835c-7.707-4.18-11.155-8.78-11.155-11.48 0-2.697 3.444-7.28 11.138-11.44l1.324-0.714 1.171-0.946-2.396 1.575c29.692-16.001 62.763-50.782 75.291-79.188 3.35-7.563 6.198-9.145 6.227-9.157a3.313 3.313 0 0 1-2.269 0c0.03 0.012 2.87 1.594 6.22 9.17 12.585 28.372 45.59 63.137 75.142 79.158l-3.02-2.112 1.409 1.237c0.094 0.086 1.75 0.978 1.75 0.978 7.72 4.16 11.177 8.738 11.177 11.426 0 2.697-3.457 7.284-11.188 11.46l-0.325 0.172-0.32 0.19 0.497-0.28c-29.964 16.317-61.781 54.51-72.443 86.952l-6.556 20.127z",fill:"#6E6E96","p-id":"5376"},null,-1),e("path",{d:"M260.791 594.531S512.522 481.175 646.873 713.4c0 0 111.116-89.82 111.116-115.81L244.53 452.98s-29.03 96.27 16.26 141.552z",fill:"#6E6E96",opacity:".25","p-id":"5377"},null,-1)]))}const C1=M(w1,[["render",k1]]),y1={},z1={t:"1754966264473",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6153",width:"16",height:"16"};function E1(r,n){return c(),f("svg",z1,n[0]||(n[0]=[e("path",{d:"M896 688.298667V469.333333h-85.333333v218.965334H285.738667L213.333333 736.554667V213.333333h341.333334V128H213.333333a85.333333 85.333333 0 0 0-85.333333 85.333333v682.666667l183.594667-122.368H810.666667a85.333333 85.333333 0 0 0 85.333333-85.333333zM810.666667 128v85.333333h85.333333v85.333334h-85.333333v85.333333h-85.333334V298.666667h-85.333333V213.333333h85.333333V128h85.333334z","p-id":"6154",fill:"currentColor"},null,-1)]))}const b1=M(y1,[["render",E1]]);async function $1(r,n){return I(`${V}/topics/`,{method:"GET",params:r})}async function M1(r,n){return I(`${V}/topics/${r}`,{method:"DELETE"})}async function S1(r,n,y){return I(`${V}/topics/${r}`,{method:"PUT",data:n})}const L1={class:"h-full flex flex-col items-center"},F1={class:"header flex items-center"},B1={class:"sidebar-fold-icon fold-right"},I1={class:"side-no-fold w-full h-full flex flex-col"},V1={key:0,class:"h-full flex flex-col"},N1={class:"sticky"},T1={class:"px-20 flex justify-between items-center"},R1={class:"header flex items-center"},A1={class:"sidebar-fold-icon"},H1={class:"scrollable flex flex-col flex-1"},q1={class:"_menu-item"},P1={class:"icon-img"},j1={class:"px-20"},D1={class:"px-20 f-items"},U1=["onClick"],G1={key:0,class:"edit-input"},J1=["value","onBlur"],K1={class:"flex-1 topic-title"},O1=["onClick"],Q1=["onClick"],W1={class:"_menu-item"},X1={class:"px-20 f-items"},Y1={class:"side-footer"},Z1={class:"flex gap-12 items-center px-20 personal-info"},e3={class:"avatar flex items-center justify-center"},t3={class:"color-gray-700"},o3={class:"m-20"},s3=G({__name:"SideBar",setup(r){const n=s1(),y=l1(),N=n1(),_=v(!1),K=U(),z=v(!1),d=v(null),w=v(null),m=v(),T=v(null),h=v(null),S=v(!1);p1(o=>$1({...o}),{paginated:!0,defaultPageSize:50,onSuccess(o){var t,i;if(m.value=o.data,!d.value){const{id:u}=n.params;if(!u)return;const g=(i=(t=o==null?void 0:o.data)==null?void 0:t.topics)==null?void 0:i.find(k=>k.id===Number(u));g&&(d.value=g)}}});const R=()=>{d.value=null,y.replace({path:"/",query:{model:"auto"}})},A=o=>{var t;d.value=o,(t=m.value.topics)!=null&&t.length?m.value.topics.unshift({topic_name:o.title,...o}):m.value.topics=[{topic_name:o.title,...o}]},O=o=>{Number(n.params.id)!==o.id&&(d.value=o,y.push({name:"chart-by-id",params:{id:o.id}}))};i1(()=>{D.on("add-task",A)});const Q=()=>{d.value=null},W=o=>{w.value=o,z.value=!0},X=o=>{h.value=o,S.value=!0,r1(()=>{var t,i;(i=(t=T.value)==null?void 0:t[0])==null||i.focus()})},Y=o=>{h.value&&(h.value.topic_name=o.target.value)},Z=o=>{var i;const t=o;S.value=!1,(i=h.value)!=null&&i.topic_name&&S1(o.id,{topic_name:h.value.topic_name}).then(()=>{var u;t.topic_name=(u=h.value)==null?void 0:u.topic_name})},e1=()=>{w.value&&M1(w.value.id).then(o=>{var t,i;if(o&&o.success){z.value=!1;const u=m.value.topics.findIndex(g=>{var k;return g.id===((k=w.value)==null?void 0:k.id)});m.value.topics.splice(u,1),((t=w.value)==null?void 0:t.id)===((i=d==null?void 0:d.value)==null?void 0:i.id)&&R(),w.value=null}})},t1=()=>{x1().then(o=>{o&&o.success&&(K.clearAuthToken(),y.replace({path:"/",query:{model:"out"}}))})};return a1(()=>D.off("add",A)),(o,t)=>{var H;const i=C("RouterLink"),u=C("el-dropdown-item"),g=C("el-dropdown-menu"),k=C("el-dropdown"),o1=C("el-popover");return c(),f("div",{id:"sidebar",class:L(["shrink-0",{"side-fold":_.value}])},[c1(e("div",L1,[e("div",F1,[s(i,{to:"/",class:"pointer"},{default:a(()=>t[6]||(t[6]=[x("Logo")])),_:1})]),e("div",B1,[s(p(j),{class:"pointer",onClick:t[0]||(t[0]=l=>_.value=!1)})])],512),[[d1,_.value]]),e("div",I1,[_.value?B("",!0):(c(),f("div",V1,[e("div",N1,[e("div",T1,[e("div",R1,[s(i,{to:"/",class:"pointer"},{default:a(()=>t[7]||(t[7]=[x("Logo")])),_:1})]),e("div",A1,[s(p(j),{class:"pointer",onClick:t[1]||(t[1]=l=>_.value=!0)})])])]),e("nav",H1,[e("aside",null,[e("div",q1,[e("div",{class:L(["group-name px-20 flex items-center",{active_on:p(n).path==="/"}])},[e("span",P1,[s(C1)]),t[8]||(t[8]=x(" 合伙人讨论区 "))],2),e("div",j1,[e("div",{class:"new-create-button flex items-center gap-2 pointer",onClick:R},[s(b1),t[9]||(t[9]=x("新对话 "))])]),e("div",D1,[(c(!0),f(q,null,u1((H=m.value)==null?void 0:H.topics,l=>{var E,b;return c(),f("div",{key:l.id,class:L(["flex justify-between items-center pointer f-item",{on:l.id===((E=d.value)==null?void 0:E.id)}]),onClick:$=>O(l)},[S.value&&((b=h.value)==null?void 0:b.id)===l.id?(c(),f("div",G1,[e("input",{ref_for:!0,ref_key:"editInput",ref:T,autofocus:"",value:l.topic_name,onInput:t[2]||(t[2]=$=>Y($)),onBlur:()=>Z(l)},null,40,J1)])):(c(),f(q,{key:1},[e("div",K1,[e("div",null,P(l.topic_name),1)]),s(k,{trigger:"click"},{dropdown:a(()=>[s(g,null,{default:a(()=>[s(u,null,{default:a(()=>[e("div",{class:"inline-flex gap-2 color-gray-700",onClick:F($=>X(l),["stop"])},[s(p(f1),{size:"20"}),t[10]||(t[10]=x("重命名 "))],8,O1)]),_:2},1024),s(u,null,{default:a(()=>[e("div",{class:"inline-flex gap-2 color-danger",onClick:F($=>W(l),["stop"])},[s(p(v1),{size:"20"}),t[11]||(t[11]=x("删除 "))],8,Q1)]),_:2},1024)]),_:2},1024)]),default:a(()=>[e("span",{class:"el-dropdown-link",onClick:t[3]||(t[3]=F(()=>{},["stop"]))},[s(p(_1),{size:"20"})])]),_:2},1024)],64))],10,U1)}),128))])]),e("div",W1,[t[13]||(t[13]=e("div",{class:"group-name tool px-20 flex items-center"}," 工具 ",-1)),e("div",X1,[e("div",{onClick:Q},[s(i,{to:"/subscription"},{default:a(()=>t[12]||(t[12]=[x("订阅")])),_:1})])])])])]),e("div",Y1,[s(o1,{placement:"top-start",width:200,trigger:"hover"},{reference:a(()=>{var l,E,b;return[e("div",Z1,[e("span",e3,[s(p(m1))]),e("span",t3,P((b=(E=(l=p(N))==null?void 0:l.initialState)==null?void 0:E.currentUser)==null?void 0:b.display_name),1)])]}),default:a(()=>[e("div",{class:"pointer",onClick:t1},"退出登录")]),_:1})])]))]),z.value?(c(),J(h1,{key:0,width:450,title:"永久删除对话",onClose:t[5]||(t[5]=l=>z.value=!1)},{default:a(()=>[e("div",null,[t[14]||(t[14]=e("div",{class:"py-20"},"删除后，该对话将不可恢复。确认删除吗？",-1)),e("div",o3,[e("button",{class:"base-button ghost-button",onClick:t[4]||(t[4]=l=>z.value=!1)}," 取消 "),e("button",{class:"base-button dangler-button",onClick:e1}," 删除 ")])])]),_:1})):B("",!0)],2)}}}),l3=M(s3,[["__scopeId","data-v-3967df64"]]),n3={class:"bg-white flex h-full w-full"},i3={class:"flex flex-col flex-1 h-full relative"},a3=G({__name:"HomeView",setup(r){const n=U();return(y,N)=>{const _=C("RouterView");return c(),f("div",n3,[p(n).isLoggedIn?(c(),J(l3,{key:0})):B("",!0),e("div",i3,[s(_)])])}}}),v3=M(a3,[["__scopeId","data-v-d369948d"]]);export{v3 as default};
